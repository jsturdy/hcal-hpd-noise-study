import sys,os
import ROOT as r
import rootGarbageCollection
samples = ["SingleMu","HcalHPDNoise","MultiJet","MET","HTMHT"]
for sample in samples:
    myFile = r.TFile("%s_hpdInformation.root"%(sample),"READ")
    eta28d1 = myFile.Get("rechitenergy/rechits_energy_ieta28p_d1")
    print eta28d1
    eta28d1.SetTitle("Rechit energy depth 1")
    eta28d1.SetXTitle("Rechit energy depth 1 [GeV]")
    eta28d1.SetYTitle("Events")
    eta28d1.SetStats(r.kFALSE)
    eta28d1.Add(myFile.Get("rechitenergy/rechits_energy_ieta28m_d1"))
    eta28d2 = myFile.Get("rechitenergy/rechits_energy_ieta28p_d2")
    eta28d2.Add(myFile.Get("rechitenergy/rechits_energy_ieta28m_d2"))
    eta28d3 = myFile.Get("rechitenergy/rechits_energy_ieta28p_d3")
    eta28d3.Add(myFile.Get("rechitenergy/rechits_energy_ieta28m_d3"))
    eta27d1 = myFile.Get("rechitenergy/rechits_energy_ieta27p_d1")
    eta27d1.Add(myFile.Get("rechitenergy/rechits_energy_ieta27m_d1"))
    eta27d2 = myFile.Get("rechitenergy/rechits_energy_ieta27p_d2")
    eta27d2.Add(myFile.Get("rechitenergy/rechits_energy_ieta27m_d2"))
    eta27d3 = myFile.Get("rechitenergy/rechits_energy_ieta27p_d3")
    eta27d3.Add(myFile.Get("rechitenergy/rechits_energy_ieta27m_d3"))
    eta26d1 = myFile.Get("rechitenergy/rechits_energy_ieta26p_d1")
    eta26d1.Add(myFile.Get("rechitenergy/rechits_energy_ieta26m_d1"))
    eta26d2 = myFile.Get("rechitenergy/rechits_energy_ieta26p_d2")
    eta26d2.Add(myFile.Get("rechitenergy/rechits_energy_ieta26m_d2"))
    eta29d1 = myFile.Get("rechitenergy/rechits_energy_ieta29p_d1")
    eta29d1.Add(myFile.Get("rechitenergy/rechits_energy_ieta29m_d1"))
    eta29d2 = myFile.Get("rechitenergy/rechits_energy_ieta29p_d2")
    eta29d2.Add(myFile.Get("rechitenergy/rechits_energy_ieta29m_d2"))
    eta28d2.SetTitle("Rechit energy depth 2")
    eta28d2.SetXTitle("Rechit energy depth 2 [GeV]")
    eta28d2.SetYTitle("Events")
    eta28d2.SetStats(r.kFALSE)
    
    eta28d3.SetTitle("Rechit energy depth 3")
    eta28d3.SetXTitle("Rechit energy depth 3 [GeV]")
    eta28d3.SetYTitle("Events")
    eta28d3.SetStats(r.kFALSE)
    
    
    eta26d1.SetLineColor(r.kRed)
    eta27d1.SetLineColor(r.kGreen)
    eta29d1.SetLineColor(r.kBlack)
    
    eta26d2.SetLineColor(r.kRed)
    eta27d2.SetLineColor(r.kGreen)
    eta29d2.SetLineColor(r.kBlack)
    
    eta27d3.SetLineColor(r.kGreen)
    
    eta28 = eta28d1.Clone("eta28")
    eta28 = eta28d1.Clone("eta28")
    eta28.Add(eta28d2)
    eta28.Add(eta28d3)
    eta28.SetTitle("Rechit energy")
    eta28.SetXTitle("Rechit energy [GeV]")
    eta28.SetYTitle("Events")
    eta28.SetStats(r.kFALSE)
    
    eta27 = eta27d1.Clone("eta27")
    eta27.Add(eta27d2)
    eta27.Add(eta27d3)
    eta26 = eta26d1.Clone("eta26")
    eta26.Add(eta26d2)
    eta29 = eta29d1.Clone("eta29")
    eta29.Add(eta29d2)
    
    outCanvas = r.TCanvas("%s_canvas"%(sample),"%s_canvas"%(sample),1024,1024)
    outCanvas.Divide(2,2)
    outCanvas.cd(1)
    plotPad_d1  = r.TPad("plotPad_d1", "plotPad_d1", 0,0.25,1,1)
    plotPad_d1.SetFillStyle(4000)
    plotPad_d1.SetTopMargin(0.05)
    plotPad_d1.SetBottomMargin(0.075)
    plotPad_d1.SetLeftMargin(0.1)
    plotPad_d1.SetRightMargin(0.025)
    plotPad_d1.SetGridy()
    plotPad_d1.SetGridx()
    plotPad_d1.SetTicks(1,1)
    outCanvas.cd(1)
    plotPad_d1.Draw()
    plotPad_d1.cd()
    plotPad_d1.SetLogy(1)

    ratioPad_d1 = r.TPad("ratioPad_d1","ratioPad_d1",0,0.05,1,0.25)
    ratioPad_d1.SetFillStyle(4000)
    ratioPad_d1.SetTopMargin(0.05)
    ratioPad_d1.SetBottomMargin(0.05)
    ratioPad_d1.SetLeftMargin(0.1)
    ratioPad_d1.SetRightMargin(0.025)
    ratioPad_d1.SetGridy()
    ratioPad_d1.SetGridx()
    ratioPad_d1.SetTicks(1,1)
    outCanvas.cd(1)
    ratioPad_d1.Draw()
    ratioPad_d1.cd()


    outCanvas.cd(1)
    plotPad_d1.cd()
    eta26d1.Rebin(10)
    eta27d1.Rebin(10)
    eta28d1.Rebin(10)
    eta29d1.Rebin(10)
    
    #eta26d1.Scale(1/eta26d1.GetEntries())
    #eta27d1.Scale(1/eta27d1.GetEntries())
    #eta28d1.Scale(1/eta28d1.GetEntries())
    #eta29d1.Scale(1/eta29d1.GetEntries())
    
    eta28d1.Draw()
    eta27d1.Draw("same")
    eta26d1.Draw("same")
    eta29d1.Draw("same")
    outCanvas.cd(1)
    ratioPad_d1.cd()

    eta27d1_ratio = eta27d1.Clone("eta27d1_ratio")
    eta27d1_ratio.Divide(eta28d1,eta27d1,1.0,1.0,"")
    eta27d1_ratio.SetTitle("")
    eta27d1_ratio.GetYaxis().SetLabelSize(0.125)
    eta26d1_ratio = eta26d1.Clone("eta26d1_ratio")
    eta26d1_ratio.Divide(eta28d1,eta26d1,1.0,1.0,"")
    eta29d1_ratio = eta29d1.Clone("eta29d1_ratio")
    eta29d1_ratio.Divide(eta28d1,eta29d1,1.0,1.0,"")

    eta27d1_ratio.SetStats(r.kFALSE)
    eta26d1_ratio.SetStats(r.kFALSE)
    eta29d1_ratio.SetStats(r.kFALSE)

    eta27d1_ratio.SetMaximum(5)
    eta27d1_ratio.SetMinimum(0)
    eta27d1_ratio.Draw("")
    eta26d1_ratio.Draw("same")
    eta29d1_ratio.Draw("same")

    #raw_input("Press Enter to continue...")
    
    outCanvas.cd(2)
    leg = r.TLegend(0.7,0.7,0.9,0.9)
    leg.SetFillColor(r.kWhite)
    leg.SetTextFont(42)
    leg.SetHeader(sample)
    leg.SetTextSize(0.035)
    plotPad_d2  = r.TPad("plotPad_d2", "plotPad_d2", 0,0.25,1,1)
    plotPad_d2.SetFillStyle(4000)
    plotPad_d2.SetTopMargin(0.05)
    plotPad_d2.SetBottomMargin(0.075)
    plotPad_d2.SetLeftMargin(0.1)
    plotPad_d2.SetRightMargin(0.025)
    plotPad_d2.SetGridy()
    plotPad_d2.SetGridx()
    plotPad_d2.SetTicks(1,1)
    outCanvas.cd(2)
    plotPad_d2.Draw()
    plotPad_d2.cd()
    plotPad_d2.SetLogy(1)

    ratioPad_d2 = r.TPad("ratioPad_d2","ratioPad_d2",0,0.05,1,0.25)
    ratioPad_d2.SetFillStyle(4000)
    ratioPad_d2.SetTopMargin(0.05)
    ratioPad_d2.SetBottomMargin(0.05)
    ratioPad_d2.SetLeftMargin(0.1)
    ratioPad_d2.SetRightMargin(0.025)
    ratioPad_d2.SetGridy()
    ratioPad_d2.SetGridx()
    ratioPad_d2.SetTicks(1,1)
    outCanvas.cd(2)
    ratioPad_d2.Draw()
    ratioPad_d2.cd()


    outCanvas.cd(2)
    plotPad_d2.cd()
    eta26d2.Rebin(10)
    eta27d2.Rebin(10)
    eta28d2.Rebin(10)
    eta29d2.Rebin(10)
    
    leg.AddEntry(eta26d2,"i#eta == 26")
    leg.AddEntry(eta27d2,"i#eta == 27")
    leg.AddEntry(eta28d2,"i#eta == 28")
    leg.AddEntry(eta29d2,"i#eta == 29")

    #eta26d2.Scale(1/eta26d2.GetEntries())
    #eta27d2.Scale(1/eta27d2.GetEntries())
    #eta28d2.Scale(1/eta28d2.GetEntries())
    #eta29d2.Scale(1/eta29d2.GetEntries())
    
    eta28d2.Draw()
    eta27d2.Draw("same")
    eta26d2.Draw("same")
    eta29d2.Draw("same")
    leg.Draw("same")
    outCanvas.cd(2)
    ratioPad_d2.cd()

    eta27d2_ratio = eta27d2.Clone("eta27d2_ratio")
    eta27d2_ratio.Divide(eta28d2,eta27d2,1.0,1.0,"")
    eta27d2_ratio.SetTitle("")
    eta27d2_ratio.GetYaxis().SetLabelSize(0.125)
    eta26d2_ratio = eta26d2.Clone("eta26d2_ratio")
    eta26d2_ratio.Divide(eta28d2,eta26d2,1.0,1.0,"")
    eta29d2_ratio = eta29d2.Clone("eta29d2_ratio")
    eta29d2_ratio.Divide(eta28d2,eta29d2,1.0,1.0,"")

    eta27d2_ratio.SetStats(r.kFALSE)
    eta26d2_ratio.SetStats(r.kFALSE)
    eta29d2_ratio.SetStats(r.kFALSE)

    eta27d2_ratio.SetMaximum(5)
    eta27d2_ratio.SetMinimum(0)
    eta27d2_ratio.Draw("")
    eta26d2_ratio.Draw("same")
    eta29d2_ratio.Draw("same")
    
    #raw_input("Press Enter to continue...")
    
    outCanvas.cd(3)
    plotPad_d3  = r.TPad("plotPad_d3", "plotPad_d3", 0,0.25,1,1)
    plotPad_d3.SetFillStyle(4000)
    plotPad_d3.SetTopMargin(0.05)
    plotPad_d3.SetBottomMargin(0.075)
    plotPad_d3.SetLeftMargin(0.1)
    plotPad_d3.SetRightMargin(0.025)
    plotPad_d3.SetGridy()
    plotPad_d3.SetGridx()
    plotPad_d3.SetTicks(1,1)
    outCanvas.cd(3)
    plotPad_d3.Draw()
    plotPad_d3.cd()
    plotPad_d3.SetLogy(1)

    ratioPad_d3 = r.TPad("ratioPad_d3","ratioPad_d3",0,0.05,1,0.25)
    ratioPad_d3.SetFillStyle(4000)
    ratioPad_d3.SetTopMargin(0.05)
    ratioPad_d3.SetBottomMargin(0.05)
    ratioPad_d3.SetLeftMargin(0.1)
    ratioPad_d3.SetRightMargin(0.025)
    ratioPad_d3.SetGridy()
    ratioPad_d3.SetGridx()
    ratioPad_d3.SetTicks(1,1)
    outCanvas.cd(3)
    ratioPad_d3.Draw()
    ratioPad_d3.cd()

    outCanvas.cd(3)
    plotPad_d3.cd()
    eta27d3.Rebin(10)
    eta28d3.Rebin(10)
    
    #eta27d3.Scale(1/eta27d3.GetEntries())
    #eta28d3.Scale(1/eta28d3.GetEntries())
    eta28d3.Scale(1/2.0)
    
    eta28d3.Draw()
    eta27d3.Draw("same")
    outCanvas.cd(3)
    ratioPad_d3.cd()

    eta27d3_ratio = eta27d3.Clone("eta27d3_ratio")
    eta27d3_ratio.Divide(eta28d3,eta27d3,1.0,1.0,"")
    eta27d3_ratio.SetTitle("")
    eta27d3_ratio.GetYaxis().SetLabelSize(0.125)
    eta27d3_ratio.SetStats(r.kFALSE)
    eta27d3_ratio.SetMaximum(5)
    eta27d3_ratio.SetMinimum(0)
    eta27d3_ratio.Draw("")

    #raw_input("Press Enter to continue...")
    
    outCanvas.cd(4)
    plotPad_all  = r.TPad("plotPad_all", "plotPad_all", 0,0.25,1,1)
    plotPad_all.SetFillStyle(4000)
    plotPad_all.SetTopMargin(0.05)
    plotPad_all.SetBottomMargin(0.075)
    plotPad_all.SetLeftMargin(0.1)
    plotPad_all.SetRightMargin(0.025)
    plotPad_all.SetGridy()
    plotPad_all.SetGridx()
    plotPad_all.SetTicks(1,1)
    outCanvas.cd(4)
    plotPad_all.Draw()
    plotPad_all.cd()
    plotPad_all.SetLogy(1)

    ratioPad_all = r.TPad("ratioPad_all","ratioPad_all",0,0.05,1,0.25)
    ratioPad_all.SetFillStyle(4000)
    ratioPad_all.SetTopMargin(0.05)
    ratioPad_all.SetBottomMargin(0.05)
    ratioPad_all.SetLeftMargin(0.1)
    ratioPad_all.SetRightMargin(0.025)
    ratioPad_all.SetGridy()
    ratioPad_all.SetGridx()
    ratioPad_all.SetTicks(1,1)
    outCanvas.cd(4)
    ratioPad_all.Draw()
    ratioPad_all.cd()


    outCanvas.cd(4)
    plotPad_all.cd()
    eta26.Rebin(10)
    eta27.Rebin(10)
    eta28.Rebin(10)
    eta29.Rebin(10)
    
    #eta26.Scale(1/eta26.GetEntries())
    #eta27.Scale(1/eta27.GetEntries())
    #eta28.Scale(1/eta28.GetEntries())
    #eta29.Scale(1/eta29.GetEntries())
    
    eta28.Draw()
    eta27.Draw("same")
    eta26.Draw("same")
    eta29.Draw("same")
    outCanvas.cd(4)
    ratioPad_all.cd()

    eta27all_ratio = eta27.Clone("eta27all_ratio")
    eta27all_ratio.Divide(eta28,eta27,1.0,1.0,"")
    eta27all_ratio.SetTitle("")
    eta27all_ratio.GetYaxis().SetLabelSize(0.125)
    eta26all_ratio = eta26.Clone("eta26all_ratio")
    eta26all_ratio.Divide(eta28,eta26,1.0,1.0,"")
    eta29all_ratio = eta29.Clone("eta29all_ratio")
    eta29all_ratio.Divide(eta28,eta29,1.0,1.0,"")

    eta27all_ratio.SetStats(r.kFALSE)
    eta26all_ratio.SetStats(r.kFALSE)
    eta29all_ratio.SetStats(r.kFALSE)

    eta27all_ratio.SetMaximum(5)
    eta27all_ratio.SetMinimum(0)
    eta27all_ratio.Draw("")
    eta26all_ratio.Draw("same")
    eta29all_ratio.Draw("same")
    raw_input("Press Enter to continue...")
    
    outCanvas.SaveAs("%s_energyDistributions.png"%(sample))
    outCanvas.SaveAs("%s_energyDistributions.pdf"%(sample))
    
